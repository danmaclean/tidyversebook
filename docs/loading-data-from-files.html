<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Using dplyr for data analysis</title>
  <meta name="description" content="An introductory course for working with tabular data in R">
  <meta name="generator" content="bookdown 0.4 and GitBook 2.6.7">

  <meta property="og:title" content="Using dplyr for data analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="An introductory course for working with tabular data in R" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Using dplyr for data analysis" />
  
  <meta name="twitter:description" content="An introductory course for working with tabular data in R" />
  

<meta name="author" content="Dan MacLean">


<meta name="date" content="2017-12-06">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="tidying-data.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a></li>
<li class="chapter" data-level="2" data-path="motivation.html"><a href="motivation.html"><i class="fa fa-check"></i><b>2</b> Motivation</a></li>
<li class="chapter" data-level="3" data-path="r-fundamentals.html"><a href="r-fundamentals.html"><i class="fa fa-check"></i><b>3</b> R Fundamentals</a></li>
<li class="chapter" data-level="4" data-path="tidy-data.html"><a href="tidy-data.html"><i class="fa fa-check"></i><b>4</b> Tidy Data</a></li>
<li class="chapter" data-level="5" data-path="dplyr-verbs.html"><a href="dplyr-verbs.html"><i class="fa fa-check"></i><b>5</b> dplyr Verbs</a></li>
<li class="chapter" data-level="6" data-path="combining-datasets.html"><a href="combining-datasets.html"><i class="fa fa-check"></i><b>6</b> Combining Datasets</a></li>
<li class="chapter" data-level="7" data-path="dplyr-and-ggplot.html"><a href="dplyr-and-ggplot.html"><i class="fa fa-check"></i><b>7</b> dplyr and ggplot</a></li>
<li class="chapter" data-level="8" data-path="tidying-data.html"><a href="tidying-data.html"><i class="fa fa-check"></i><b>8</b> Tidying data</a></li>
<li class="chapter" data-level="9" data-path="loading-data-from-files.html"><a href="loading-data-from-files.html"><i class="fa fa-check"></i><b>9</b> Loading data from files</a><ul>
<li class="chapter" data-level="9.1" data-path="loading-data-from-files.html"><a href="loading-data-from-files.html#about-this-chapter"><i class="fa fa-check"></i><b>9.1</b> About this chapter</a></li>
<li class="chapter" data-level="9.2" data-path="loading-data-from-files.html"><a href="loading-data-from-files.html#readr"><i class="fa fa-check"></i><b>9.2</b> readr</a><ul>
<li class="chapter" data-level="9.2.1" data-path="loading-data-from-files.html"><a href="loading-data-from-files.html#read_csv"><i class="fa fa-check"></i><b>9.2.1</b> read_csv()</a></li>
<li class="chapter" data-level="9.2.2" data-path="loading-data-from-files.html"><a href="loading-data-from-files.html#parser-functions"><i class="fa fa-check"></i><b>9.2.2</b> Parser functions</a></li>
<li class="chapter" data-level="9.2.3" data-path="loading-data-from-files.html"><a href="loading-data-from-files.html#headers-and-column-names"><i class="fa fa-check"></i><b>9.2.3</b> Headers and column names</a></li>
<li class="chapter" data-level="9.2.4" data-path="loading-data-from-files.html"><a href="loading-data-from-files.html#missing-values"><i class="fa fa-check"></i><b>9.2.4</b> Missing values</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="loading-data-from-files.html"><a href="loading-data-from-files.html#writing-files"><i class="fa fa-check"></i><b>9.3</b> Writing Files</a></li>
<li class="chapter" data-level="9.4" data-path="loading-data-from-files.html"><a href="loading-data-from-files.html#readxl"><i class="fa fa-check"></i><b>9.4</b> readxl</a><ul>
<li class="chapter" data-level="9.4.1" data-path="loading-data-from-files.html"><a href="loading-data-from-files.html#read_excel"><i class="fa fa-check"></i><b>9.4.1</b> read_excel()</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Using dplyr for data analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="loading-data-from-files" class="section level1">
<h1><span class="header-section-number">Topic 9</span> Loading data from files</h1>
<div id="about-this-chapter" class="section level2">
<h2><span class="header-section-number">9.1</span> About this chapter</h2>
<ol style="list-style-type: decimal">
<li>Questions:</li>
</ol>
<ul>
<li>How do I get my data into R?</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Objectives:</li>
</ol>
<ul>
<li>Loading a ‘.csv’ file</li>
<li>Checking column contents</li>
<li>Dealing with headers and column names</li>
<li>Loading a specific sheet from a ‘.xlsx’ file.</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Keypoints:</li>
</ol>
<ul>
<li>The <code>readr</code> and <code>readxl</code> packages contain functions for loading data from .csv and .xslx files. These functions help you to ensure that your data is loaded as you expect.</li>
</ul>
</div>
<div id="readr" class="section level2">
<h2><span class="header-section-number">9.2</span> readr</h2>
<p>readr is a tool for loading data into R. As part of the tidyverse it is loaded when you use <code>library(tidyverse)</code> but can be loaded on its own with <code>library(readr)</code>. We will use <code>readr</code> to load in data from a ‘flat’ <code>.csv</code> file. Most</p>
<div id="read_csv" class="section level3">
<h3><span class="header-section-number">9.2.1</span> read_csv()</h3>
<p>The main function is <code>read_csv()</code> which can read a standard comma seperated values file from disk into an R dataframe. There are a few variants of <code>read_csv()</code> which may be appropriate for different sorts of <code>.csv</code> file, but they all work the same.</p>
<ul>
<li><code>read_csv2()</code> - reads semi-colon delimited files, which are commonly used where a comma is used as a decimal separator</li>
<li><code>read_tsv()</code> - reads tab delimited files</li>
<li><code>read_delim()</code> - reads files delimited by an arbitrary character</li>
</ul>
<p>The first argument to <code>read_csv()</code> is the path to the file to read. Here I’ll read a file on my Desktop that contains the diamonds data we’ve been using.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">read_csv</span>(<span class="st">&quot;~/Desktop/diamonds.csv&quot;</span>)</code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   carat = col_double(),
##   cut = col_character(),
##   color = col_character(),
##   clarity = col_character(),
##   depth = col_double(),
##   table = col_double(),
##   price = col_integer(),
##   x = col_double(),
##   y = col_double(),
##   z = col_double()
## )</code></pre>
<pre><code>## # A tibble: 53,940 x 10
##    carat       cut color clarity depth table price     x     y     z
##    &lt;dbl&gt;     &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1  0.23     Ideal     E     SI2  61.5    55   326  3.95  3.98  2.43
##  2  0.21   Premium     E     SI1  59.8    61   326  3.89  3.84  2.31
##  3  0.23      Good     E     VS1  56.9    65   327  4.05  4.07  2.31
##  4  0.29   Premium     I     VS2  62.4    58   334  4.20  4.23  2.63
##  5  0.31      Good     J     SI2  63.3    58   335  4.34  4.35  2.75
##  6  0.24 Very Good     J    VVS2  62.8    57   336  3.94  3.96  2.48
##  7  0.24 Very Good     I    VVS1  62.3    57   336  3.95  3.98  2.47
##  8  0.26 Very Good     H     SI1  61.9    55   337  4.07  4.11  2.53
##  9  0.22      Fair     E     VS2  65.1    61   337  3.87  3.78  2.49
## 10  0.23 Very Good     H     VS1  59.4    61   338  4.00  4.05  2.39
## # ... with 53,930 more rows</code></pre>
<p>On loading we see a column specification, <code>read_csv()</code> has guessed at what the columns should be and made those types. Its fine for the most part, but some of those columns we’d prefer to be factors. We can set our own column specification to force the column types on loading. We only have to do the ones that <code>read_csv()</code> gets wrong. Specifically, lets fix <code>cut</code> and <code>color</code> to a <code>factor</code>. We can do that with the <code>col_types</code> argument.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">read_csv</span>(<span class="st">&quot;~/Desktop/diamonds.csv&quot;</span>,
    <span class="dt">col_types =</span> <span class="kw">cols</span>(
      <span class="dt">cut =</span> <span class="kw">col_factor</span>(<span class="ot">NULL</span>),
      <span class="dt">color =</span> <span class="kw">col_factor</span>(<span class="ot">NULL</span>)
    )
)</code></pre></div>
<pre><code>## # A tibble: 53,940 x 10
##    carat       cut  color clarity depth table price     x     y     z
##    &lt;dbl&gt;    &lt;fctr&gt; &lt;fctr&gt;   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1  0.23     Ideal      E     SI2  61.5    55   326  3.95  3.98  2.43
##  2  0.21   Premium      E     SI1  59.8    61   326  3.89  3.84  2.31
##  3  0.23      Good      E     VS1  56.9    65   327  4.05  4.07  2.31
##  4  0.29   Premium      I     VS2  62.4    58   334  4.20  4.23  2.63
##  5  0.31      Good      J     SI2  63.3    58   335  4.34  4.35  2.75
##  6  0.24 Very Good      J    VVS2  62.8    57   336  3.94  3.96  2.48
##  7  0.24 Very Good      I    VVS1  62.3    57   336  3.95  3.98  2.47
##  8  0.26 Very Good      H     SI1  61.9    55   337  4.07  4.11  2.53
##  9  0.22      Fair      E     VS2  65.1    61   337  3.87  3.78  2.49
## 10  0.23 Very Good      H     VS1  59.4    61   338  4.00  4.05  2.39
## # ... with 53,930 more rows</code></pre>
</div>
<div id="parser-functions" class="section level3">
<h3><span class="header-section-number">9.2.2</span> Parser functions</h3>
<p>This works by assigning a parser function that returns a specific type to each column, here it’s <code>col_factor()</code>. There are parser functions for all types of data, and all of them can be used if <code>read_csv()</code> doesn’t guess your data properly. We won’t go into detail of all of them, just remember that if your numbers or dates or stuff won’t load properly, there’s a parser function that can help.</p>
<p>The parser functions all have their own arguments, so we can manipulate those. We can see the <code>NULL</code> argument being passed to <code>col_factor()</code> above, which means ‘all values found should be used as levels of the factor’. This is a great default setting, but if we have a large file, it won’t help us find unexpected values.</p>
<p>Consider a situation where we are certain we should only have the values <code>Fair</code>, <code>Good</code> and <code>Very Good</code> for <code>cut</code> in our <code>diamonds</code> data. We can make the parser function check this for us and give a warning if it finds anything else.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">read_csv</span>(<span class="st">&quot;~/Desktop/diamonds.csv&quot;</span>,
    <span class="dt">col_types =</span> <span class="kw">cols</span>(
      <span class="dt">cut =</span> <span class="kw">col_factor</span>(<span class="dt">levels =</span> <span class="kw">c</span>( <span class="st">&quot;Fair&quot;</span> ,<span class="st">&quot;Good&quot;</span>, <span class="st">&quot;Very Good&quot;</span>)),
      <span class="dt">color =</span> <span class="kw">col_factor</span>(<span class="ot">NULL</span>)
    )
)</code></pre></div>
<pre><code>## Warning in rbind(names(probs), probs_f): number of columns of result is not
## a multiple of vector length (arg 1)</code></pre>
<pre><code>## Warning: 35342 parsing failures.
## row # A tibble: 5 x 5 col     row   col           expected  actual                     file expected   &lt;int&gt; &lt;chr&gt;              &lt;chr&gt;   &lt;chr&gt;                    &lt;chr&gt; actual 1     1   cut value in level set   Ideal &#39;~/Desktop/diamonds.csv&#39; file 2     2   cut value in level set Premium &#39;~/Desktop/diamonds.csv&#39; row 3     4   cut value in level set Premium &#39;~/Desktop/diamonds.csv&#39; col 4    12   cut value in level set   Ideal &#39;~/Desktop/diamonds.csv&#39; expected 5    13   cut value in level set Premium &#39;~/Desktop/diamonds.csv&#39;
## ... ................. ... ................................................................. ........ ................................................................. ...... ................................................................. .... ................................................................. ... ................................................................. ... ................................................................. ........ .................................................................
## See problems(...) for more details.</code></pre>
<pre><code>## # A tibble: 53,940 x 10
##    carat       cut  color clarity depth table price     x     y     z
##    &lt;dbl&gt;    &lt;fctr&gt; &lt;fctr&gt;   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1  0.23      &lt;NA&gt;      E     SI2  61.5    55   326  3.95  3.98  2.43
##  2  0.21      &lt;NA&gt;      E     SI1  59.8    61   326  3.89  3.84  2.31
##  3  0.23      Good      E     VS1  56.9    65   327  4.05  4.07  2.31
##  4  0.29      &lt;NA&gt;      I     VS2  62.4    58   334  4.20  4.23  2.63
##  5  0.31      Good      J     SI2  63.3    58   335  4.34  4.35  2.75
##  6  0.24 Very Good      J    VVS2  62.8    57   336  3.94  3.96  2.48
##  7  0.24 Very Good      I    VVS1  62.3    57   336  3.95  3.98  2.47
##  8  0.26 Very Good      H     SI1  61.9    55   337  4.07  4.11  2.53
##  9  0.22      Fair      E     VS2  65.1    61   337  3.87  3.78  2.49
## 10  0.23 Very Good      H     VS1  59.4    61   338  4.00  4.05  2.39
## # ... with 53,930 more rows</code></pre>
<p>This time, we get a large number of warnings. Though the output is quite cryptic at first glance, <code>read_csv()</code> is complaining that it found values for cut that were not in the list we passed to the parser function.</p>
<p>Hence we can use parsers to ensure we are loading in the data we expect and generate errors if not.</p>
</div>
<div id="headers-and-column-names" class="section level3">
<h3><span class="header-section-number">9.2.3</span> Headers and column names</h3>
<p>By default <code>read_csv()</code> uses the first line of the file for column names. Consider this toy example.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">toy_csv &lt;-<span class="st"> </span>
<span class="st">&quot;a,b,c</span>
<span class="st">1,2,3</span>
<span class="st">4,5,6&quot;</span>
<span class="kw">read_csv</span>(toy_csv)</code></pre></div>
<pre><code>## # A tibble: 2 x 3
##       a     b     c
##   &lt;int&gt; &lt;int&gt; &lt;int&gt;
## 1     1     2     3
## 2     4     5     6</code></pre>
<p>The first line of the toy file becomes the column headings. This may not be appropriate, since there could be some metadata in the file</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">toy_csv &lt;-<span class="st"> </span>
<span class="st">&quot;some info about stuff</span>
<span class="st">a,b,c</span>
<span class="st">1,2,3</span>
<span class="st">4,5,6&quot;</span>
<span class="kw">read_csv</span>(toy_csv)</code></pre></div>
<pre><code>## Warning in rbind(names(probs), probs_f): number of columns of result is not
## a multiple of vector length (arg 1)</code></pre>
<pre><code>## Warning: 3 parsing failures.
## row # A tibble: 3 x 5 col     row   col  expected    actual         file expected   &lt;int&gt; &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;        &lt;chr&gt; actual 1     1  &lt;NA&gt; 1 columns 3 columns literal data file 2     2  &lt;NA&gt; 1 columns 3 columns literal data row 3     3  &lt;NA&gt; 1 columns 3 columns literal data</code></pre>
<pre><code>## # A tibble: 3 x 1
##   `some info about stuff`
##                     &lt;chr&gt;
## 1                       a
## 2                       1
## 3                       4</code></pre>
<p>The loaded data gets really messed up, so we can skip a set number of lines if needed</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">toy_csv &lt;-<span class="st"> </span>
<span class="st">&quot;some info about stuff</span>
<span class="st">a,b,c</span>
<span class="st">1,2,3</span>
<span class="st">4,5,6&quot;</span>
<span class="kw">read_csv</span>(toy_csv, <span class="dt">skip =</span> <span class="dv">1</span>)</code></pre></div>
<pre><code>## # A tibble: 2 x 3
##       a     b     c
##   &lt;int&gt; &lt;int&gt; &lt;int&gt;
## 1     1     2     3
## 2     4     5     6</code></pre>
<p>Alternatively, you might have comments that begin with a particular character. You can use the <code>comment</code> argument to skip those lines</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">toy_csv &lt;-<span class="st"> </span>
<span class="st">&quot;#some info about stuff</span>
<span class="st">#some more info</span>
<span class="st">#goodness, lots of INFO</span>
<span class="st">a,b,c</span>
<span class="st">1,2,3</span>
<span class="st">4,5,6&quot;</span>
<span class="kw">read_csv</span>(toy_csv, <span class="dt">comment =</span> <span class="st">&quot;#&quot;</span>)</code></pre></div>
<pre><code>## # A tibble: 2 x 3
##       a     b     c
##   &lt;int&gt; &lt;int&gt; &lt;int&gt;
## 1     1     2     3
## 2     4     5     6</code></pre>
<p>The data might not have any column names at all, the first row may data. This situation is handled with <code>col_names</code> argument</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">toy_csv &lt;-<span class="st"> </span>
<span class="st">&quot;1,2,3</span>
<span class="st">4,5,6&quot;</span>
<span class="kw">read_csv</span>(toy_csv, <span class="dt">col_names =</span> <span class="ot">FALSE</span>)</code></pre></div>
<pre><code>## # A tibble: 2 x 3
##      X1    X2    X3
##   &lt;int&gt; &lt;int&gt; &lt;int&gt;
## 1     1     2     3
## 2     4     5     6</code></pre>
<p>So, <code>read_csv()</code> sets up arbitrary column names. We can specify column names if we wish</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">toy_csv &lt;-<span class="st"> </span>
<span class="st">&quot;a,b,c</span>
<span class="st">1,2,3</span>
<span class="st">4,5,6&quot;</span>
<span class="kw">read_csv</span>(toy_csv, <span class="dt">col_names =</span> <span class="kw">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>, <span class="st">&quot;z&quot;</span>))</code></pre></div>
<pre><code>## # A tibble: 3 x 3
##       x     y     z
##   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
## 1     a     b     c
## 2     1     2     3
## 3     4     5     6</code></pre>
</div>
<div id="missing-values" class="section level3">
<h3><span class="header-section-number">9.2.4</span> Missing values</h3>
<p>There are many different ways of encoding missing values, you can tell <code>read_csv()</code> which character represents a missing value explicitly with the <code>na</code> argument. These values will all be loaded as proper <code>NA</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">toy_csv &lt;-<span class="st"> </span>
<span class="st">&quot;a,b,c</span>
<span class="st">1,_,3</span>
<span class="st">4,5,_&quot;</span>
<span class="kw">read_csv</span>(toy_csv, <span class="dt">na =</span> <span class="st">&quot;_&quot;</span>)</code></pre></div>
<pre><code>## # A tibble: 2 x 3
##       a     b     c
##   &lt;int&gt; &lt;int&gt; &lt;int&gt;
## 1     1    NA     3
## 2     4     5    NA</code></pre>
</div>
</div>
<div id="writing-files" class="section level2">
<h2><span class="header-section-number">9.3</span> Writing Files</h2>
<p>A complementary functionto <code>read_csv()</code> <code>write_csv()</code> allows you to write a dataframe out to a ‘.csv’ file. The convention is straightforward, you need the name of the dataframe and the name of the file and path to write to.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">write_csv</span>(diamonds, <span class="st">&quot;~/Desktop/my_data.csv&quot;</span>)</code></pre></div>
</div>
<div id="readxl" class="section level2">
<h2><span class="header-section-number">9.4</span> readxl</h2>
<p>The <code>readxl</code> package is installed as part of the tidyvers <code>install.packages()</code> command, but it is not part of the core, so <code>library(tidyverse)</code> does not load it. You must do it explicitly with <code>library(readxl)</code>.</p>
<div id="read_excel" class="section level3">
<h3><span class="header-section-number">9.4.1</span> read_excel()</h3>
<p>The main function is <code>read_excel()</code>, it’s similar to <code>read_csv()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(readxl)
<span class="kw">read_excel</span>(<span class="st">&quot;~/Desktop/datasets.xls&quot;</span>)</code></pre></div>
<pre><code>## # A tibble: 150 x 5
##    Sepal.Length Sepal.Width Petal.Length Petal.Width Species
##           &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;   &lt;chr&gt;
##  1          5.1         3.5          1.4         0.2  setosa
##  2          4.9         3.0          1.4         0.2  setosa
##  3          4.7         3.2          1.3         0.2  setosa
##  4          4.6         3.1          1.5         0.2  setosa
##  5          5.0         3.6          1.4         0.2  setosa
##  6          5.4         3.9          1.7         0.4  setosa
##  7          4.6         3.4          1.4         0.3  setosa
##  8          5.0         3.4          1.5         0.2  setosa
##  9          4.4         2.9          1.4         0.2  setosa
## 10          4.9         3.1          1.5         0.1  setosa
## # ... with 140 more rows</code></pre>
<p>By default it loads the first worksheet, you can examine the sheets available with <code>excel_sheets()</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">excel_sheets</span>(<span class="st">&quot;~/Desktop/datasets.xls&quot;</span>)</code></pre></div>
<pre><code>## [1] &quot;iris&quot;     &quot;mtcars&quot;   &quot;chickwts&quot; &quot;quakes&quot;</code></pre>
<p>Then load in the one you want.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">read_excel</span>(<span class="st">&quot;~/Desktop/datasets.xls&quot;</span>, <span class="dt">sheet =</span> <span class="st">&quot;chickwts&quot;</span>)</code></pre></div>
<pre><code>## # A tibble: 71 x 2
##    weight      feed
##     &lt;dbl&gt;     &lt;chr&gt;
##  1    179 horsebean
##  2    160 horsebean
##  3    136 horsebean
##  4    227 horsebean
##  5    217 horsebean
##  6    168 horsebean
##  7    108 horsebean
##  8    124 horsebean
##  9    143 horsebean
## 10    140 horsebean
## # ... with 61 more rows</code></pre>
<p>Loading then follows the same pattern as for <code>read_csv()</code>, with a difference in the column specifications - in this package its much simpler. You can only specify type columnwise and the specification can only be one of “skip”, “guess”, “logical”, “numeric”, “date”, “text” or “list” - meaning you can’t do the advanced parsing as for <code>read_csv()</code>.</p>
<p>A sample spec might look like</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">read_excel</span>(
  <span class="st">&quot;~/Desktop/datasets.xls&quot;</span>, 
  <span class="dt">sheet =</span> <span class="st">&quot;chickwts&quot;</span>,
  <span class="dt">col_types =</span> <span class="kw">c</span>(<span class="st">&quot;numeric&quot;</span>, <span class="st">&quot;text&quot;</span>)
  )</code></pre></div>
<pre><code>## # A tibble: 71 x 2
##    weight      feed
##     &lt;dbl&gt;     &lt;chr&gt;
##  1    179 horsebean
##  2    160 horsebean
##  3    136 horsebean
##  4    227 horsebean
##  5    217 horsebean
##  6    168 horsebean
##  7    108 horsebean
##  8    124 horsebean
##  9    143 horsebean
## 10    140 horsebean
## # ... with 61 more rows</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="tidying-data.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
